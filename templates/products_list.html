{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Products</h3>

  {% if user.role == 'admin' %}
  <a class="btn btn-success" href="{{ url_for('product_new') }}">+ Add Product</a>
  {% endif %}
</div>

<div class="table-responsive">
  <table class="table table-striped table-bordered table-hover bg-white align-middle">
    <thead class="table-dark">
    <tr>
      <th>ID</th>
      <th>Name</th>
      <th>Qty</th>
      <th>Price</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    {% for p in products %}
    <tr>
      <td>{{ p.product_id }}</td>
      <td>{{ p.product_name }}</td>
      <td>{{ p.quantity }}</td>
      <td>{{ "%.2f"|format(p.price) }}</td>
      <td>
        {% if user.role == 'admin' %}
          <a class="btn btn-sm btn-primary"
             href="{{ url_for('product_edit', product_id=p.id) }}">Edit</a>
          <form action="{{ url_for('product_delete', product_id=p.product_id) }}"
                method="post" style="display:inline;"
                onsubmit="return confirm('Delete this product?');">
            <button class="btn btn-sm btn-danger">Delete</button>
          </form>
        {% else %}
          <span class="text-muted">View Only</span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}
